[workspace]
channels = ["conda-forge"]
name = "isaac_lab"
platforms = ["linux-64", "win-64"]
version = "0.1.0"

[system-requirements]
libc = { family = "glibc", version = "2.35" }

[dependencies]
python = "3.11.*"
git = "*"
pip = "*"

[pypi-options]
extra-index-urls = ["https://pypi.nvidia.com"]

[pypi-dependencies]
torch = { version = "==2.7.0", index = "https://download.pytorch.org/whl/cu128" }
torchvision = { version = "==0.22.0", index = "https://download.pytorch.org/whl/cu128" }
isaacsim = { version = "==5.1.0", extras = ["all", "extscache"] }

[tasks]
# Cross-platform tasks
clone-isaaclab = "git clone https://github.com/isaac-sim/IsaacLab.git"
test-import = "python -c \"import isaaclab; print('Isaac Lab installed:', isaaclab.__file__)\""
test-torch = "python -c \"import torch; print('CUDA available:', torch.cuda.is_available())\""
verify = { depends-on = ["test-import", "test-torch"] }

## Isaac Sim
isaac-sim = "isaacsim"

## Isaac Lab demos
lab-arms = "python IsaacLab/scripts/demos/arms.py"
lab-quadrupeds = "python IsaacLab/scripts/demos/quadrupeds.py"
lab-cartpole = "python IsaacLab/scripts/demos/cartpole.py"
lab-markers = "python IsaacLab/scripts/demos/markers.py"

# Linux-specific
[target.linux-64.tasks]
install-isaaclab = { cmd = "cd IsaacLab && chmod +x isaaclab.sh && ./isaaclab.sh --install", depends-on = ["clone-isaaclab"] }
setup = { depends-on = ["install-isaaclab"] }
lab-list-demos = "ls -1 IsaacLab/scripts/demos/*.py"
clean = "rm -rf IsaacLab .pixi pixi.lock"

# Windows-specific
[target.win-64.tasks]
install-isaaclab-win = { cmd = "IsaacLab\\isaaclab.bat --install", depends-on = ["clone-isaaclab"] }
setup-win = { depends-on = ["install-isaaclab-win"] }
setup = { depends-on = ["install-isaaclab-win"] }
lab-list-demos = "dir /b IsaacLab\\scripts\\demos\\*.py"
clean = "if exist IsaacLab rmdir /s /q IsaacLab && if exist .pixi rmdir /s /q .pixi && if exist pixi.lock del pixi.lock"
